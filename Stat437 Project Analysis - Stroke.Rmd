---
title: "Stat437 Project Analysis - Stroke"
author: "Emily Liu and Aaron Chan"
date: "3/4/2021"
output: html_document
---

```{r}
# libraries
library(tableone)
library(Matching)
library(tidyverse)

# read in Prediction of Cerebral Stroke dataset (Source: https://dataverse.harvard.edu/file.xhtml?fileId=4402679&version=1.0)
stroke <- vroom::vroom("~/Documents/Winter 2021/Strokesdataset.csv")
```

# Data cleaning
```{r}
# Change all categorical variables to factors
stroke$gender <- as.factor(stroke$gender)
stroke$heart_disease <- as.factor(stroke$heart_disease)
stroke$ever_married <- as.factor(stroke$ever_married)
stroke$is_self_employed <- stroke$work_type
stroke$Residence_type <- as.factor(stroke$Residence_type)
stroke$smoking_status <- as.factor(stroke$smoking_status)

# Create new column "is_self_employed" changing work_type variable to binary outcome 
# (self-employed = 1, not self-emplyed = 0)
for(i in 1:length(stroke$is_self_employed)) {
        if(stroke$is_self_employed[i] == "Self-employed") {
                stroke$is_self_employed[i] = 1
        } else {
                stroke$is_self_employed[i] = 0
        }
}

# Change variables in newly created is_self_employed column to factor
stroke$is_self_employed <- as.factor(stroke$is_self_employed)

# Create list of covariates to be used in following Table 1
xvars <- c("gender", "age", "hypertension", "heart_disease", "ever_married", "Residence_type", "avg_glucose_level", "bmi", "smoking_status")
```

# Create Table 1
```{r}
table1 <- CreateTableOne(vars = xvars, strata = "is_self_employed", data = stroke, test = FALSE)
print(table1, smd = TRUE)
```
